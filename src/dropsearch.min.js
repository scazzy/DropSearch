/*!
 * DropSearch
 * https://github.com/scazzy/DropSearch/
 * 
 * Twitter: @eltonjain
 */
(function(){window.DropSearch=function(l){function m(a,b,d){var f=b.children("."+c.eleResultListClass),e=f.children("li"),g=b.children("."+c.eleInputClass),h=!1;a.on("change",function(){var d=a.find("option:selected"),d=k(d);b.find("."+c.eleInputClass).val("");b.find("li").css("display","list-item");""!==d.value&&g.val(d.name)});g.on("focus",function(){f.show()}).on("blur",function(){setTimeout(function(){!1===h&&f.hide()},50)}).on("keyup",function(){var b=$(this),b=$.trim(b.val());""===b?e.css("display",
"list-item"):(b=d.search(b),e.css("display","none"),0<b.length?($.each(b,function(b,a){e.filter("[data-val="+a+"]").css("display","list-item")}),f.show()):f.hide(),a.val(""));if(c.onSearch)c.onSearch()});e.on("click",function(b){b.preventDefault();h=!0;g.val($(this).html());a.val($(this).data("val"));h=!1});a.trigger("change")}function n(a){var b=[];$.each(a.find("option"),function(a){a=$(this);a=k(a);a.value&&b.push(a)});return b}function k(a){var b=a.html();a=a.attr("value");void 0===a?a=b:""===
a&&(a="");return{name:b,value:a}}var c=$.extend({$select:null,eleContainerClass:"dropsearch",eleInputClass:"dropsearch-input",eleResultListClass:"dropsearch-bucket",onInit:null,onSearch:null},l);(function(){if(c.$select)$.each(c.$select,function(){var a=$(this),b=n(a),d;c.placeholder=a.data("placeholder")||"";var f=$("<div>").addClass(c.eleContainerClass);d=$('<input type="text">').addClass(c.eleInputClass).attr("placeholder",c.placeholder);var e=$("<ul>").addClass(c.eleResultListClass);f.append(d).append(e);
d="";for(e=0;e<b.length;e++)d+="<li data-val='"+b[e].value+"'>"+b[e].name+"</li>";a.hide();f.find("."+c.eleResultListClass).html(d);a.after(f);b=new Fuse(b,{keys:["name"],id:"value",location:c.location||0,threshold:c.threshold||.61,distance:c.distance||100,maxPatternLength:c.maxPatternLength||64,caseSensitive:c.caseSensitive||!1,includeScore:c.includeScore||!1,shouldSort:c.shouldSort||!0});m(a,f,b)});else throw"Invalid Source";if(c.onInit)c.onInit()})()}})();